<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Editor de Código HTML</title>
<link rel="stylesheet" href="codemirror.css">
<style>
  body {
    background-color: #333;
    font-family: 'Courier New', monospace;
    color: #fff;
    padding: 20px;
  }
  .CodeMirror {
    border: 1px solid #555;
    border-radius: 5px;
    height: auto;
  }
  .button {
    background-color: #0078d7;
    border: none;
    color: white;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 5px;
  }
  #preview {
    border: 1px solid #555;
    padding: 20px;
    margin-top: 50px;
    background-color: #fff;
    color: #000;
    overflow: auto;
  }
</style>
</head>
<body>

<input type="file" id="fileUploader" accept=".html" style="display:none" onchange="cargarArchivo(event)" />
<textarea id="editor" placeholder="Pega tu código HTML aquí..."></textarea>
<button class="button" onclick="mostrarVistaPrevia()">▶️</button>
<button class="button" onclick="document.getElementById('fileUploader').click()">Subir Archivo</button>
<input type="text" id="extension" placeholder="Escribe la extensión (ej. .txt)" />
<button class="button" onclick="descargarArchivo()">Descargar</button>
<div id="preview"></div>

<script src="codemirror.js"></script>
<script src="xml.js"></script>
<script src="closebrackets.js"></script>
<script>
  var editor = CodeMirror.fromTextArea(document.getElementById('editor'), {
    mode: 'xml',
    lineNumbers: true,
    autoCloseTags: true,
    autoCloseBrackets: true
  });

  function mostrarVistaPrevia() {
    var codigo = editor.getValue();
    try {
      document.getElementById('preview').innerHTML = codigo;
    } catch (e) {
      document.getElementById('preview').innerHTML = "Error: " + e.message;
    }
  }

  function cargarArchivo(event) {
    var reader = new FileReader();
    reader.onload = function(){
      editor.setValue(reader.result);
    };
    reader.readAsText(event.target.files[0]);
  }

  function descargarArchivo() {
    var texto = editor.getValue();
    var extension = document.getElementById('extension').value || '.html';
    var blob = new Blob([texto], {type: 'text/plain'});
    var anchor = document.createElement('a');
    anchor.download = 'archivo' + extension;
    anchor.href = window.URL.createObjectURL(blob);
    anchor.click();
  }

  document.getElementById('fileUploader').addEventListener('change', cargarArchivo);
</script>

</body>
</html>
